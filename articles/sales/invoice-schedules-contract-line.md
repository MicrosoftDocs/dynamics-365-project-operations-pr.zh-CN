---
title: 根据基于项目的合同子项创建账单计划
description: 此主题提供有关如何在合同子项上创建发票计划和里程碑的信息。
author: rumant
manager: Annbe
ms.date: 10/17/2020
ms.topic: article
ms.service: project-operations
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: b2fbec567c07d7567f1d133fa3512496039f16a1
ms.sourcegitcommit: 869bde007805ef255f61b03937e4a44aeef61df9
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/12/2020
ms.locfileid: "4513913"
---
# <a name="create-an-invoice-schedule-on-a-project-based-contract-line"></a><span data-ttu-id="44a6d-103">根据基于项目的合同子项创建账单计划</span><span class="sxs-lookup"><span data-stu-id="44a6d-103">Create an invoice schedule on a project-based contract line</span></span> 

<span data-ttu-id="44a6d-104">_**适用于：** 面向资源/非库存场景的 Project Operations_</span><span class="sxs-lookup"><span data-stu-id="44a6d-104">_**Applies To:** Project Operations for resource/non-stocked based scenarios_</span></span>

<span data-ttu-id="44a6d-105">您可以为基于项目的合同子项创建发票计划。</span><span class="sxs-lookup"><span data-stu-id="44a6d-105">You can an invoice schedule to a  project-based contract line.</span></span> <span data-ttu-id="44a6d-106">仅在合同赢单并且您在创建项目合同之后才允许开票。</span><span class="sxs-lookup"><span data-stu-id="44a6d-106">Invoicing is only allowed after the contract is won to and you are creating a project contract.</span></span> <span data-ttu-id="44a6d-107">通过发票计划，可以为基于项目的合同子项自动创建草稿发票。</span><span class="sxs-lookup"><span data-stu-id="44a6d-107">An invoice schedule allows draft invoices for a project-based contract line to be automatically created.</span></span> <span data-ttu-id="44a6d-108">不过，如果您只手动创建发票，则可以跳过在合同子项上创建发票计划。</span><span class="sxs-lookup"><span data-stu-id="44a6d-108">If however, you only manually create invoices, you can skip creating invoice schedules on contract lines.</span></span>

## <a name="create-a-time-and-material-invoice-schedule-for-a-contract-line"></a><span data-ttu-id="44a6d-109">为合同子项创建时间和材料发票计划</span><span class="sxs-lookup"><span data-stu-id="44a6d-109">Create a time and material invoice schedule for a contract line</span></span>

<span data-ttu-id="44a6d-110">当基于项目的合同子项使用时间和材料计费方法时，您可以创建基于日期的发票计划。</span><span class="sxs-lookup"><span data-stu-id="44a6d-110">When a project-based contract line has a time and material billing method, you can create a date-based invoice schedule.</span></span> <span data-ttu-id="44a6d-111">若要自动生成基于日期的发票计划，请完成以下步骤。</span><span class="sxs-lookup"><span data-stu-id="44a6d-111">To automatically generate a date-based invoice schedule, complete the following steps.</span></span>

1. <span data-ttu-id="44a6d-112">转到 **设置** > **发票频率**，设置发票频率。</span><span class="sxs-lookup"><span data-stu-id="44a6d-112">Go to **Settings** > **Invoice frequencies** and set up an invoice frequence.</span></span>
2. <span data-ttu-id="44a6d-113">转到项目合同记录，在 **摘要** 选项卡上的 **要求交货日期** 字段中，选择日期。</span><span class="sxs-lookup"><span data-stu-id="44a6d-113">Go to the project contract record, and on the **Summary** tab, in the **Requested Delivery Date** field, select a date.</span></span>
3. <span data-ttu-id="44a6d-114">打开您要为其创建基于日期的发票计划的 **时间和材料** 合同子项。</span><span class="sxs-lookup"><span data-stu-id="44a6d-114">Open the **Time and Material** contract line that you are making the date-based invoice schedule for.</span></span> 
4. <span data-ttu-id="44a6d-115">在 **发票计划** 选项卡上，选择记帐开始日期和发票频率。</span><span class="sxs-lookup"><span data-stu-id="44a6d-115">On the **Invoice Schedule** tab, select the billing start date and the invoice frequency.</span></span>
5. <span data-ttu-id="44a6d-116">在子网格上，选择 **生成发票计划**。</span><span class="sxs-lookup"><span data-stu-id="44a6d-116">On the subgrid, select **Generate Invoice Schedule**.</span></span> <span data-ttu-id="44a6d-117">发票计划将生成，并按照以下方式设置 **发票运行日期**、**交易截止日期** 和 **运行状态** 字段：</span><span class="sxs-lookup"><span data-stu-id="44a6d-117">The invoice schedule is generated with the **Invoice Run Date**, **Transaction Cutoff Date** and **Run Status** fields set as follows:</span></span>

    - <span data-ttu-id="44a6d-118">**发票运行日期**：此日期由发票频率指示。</span><span class="sxs-lookup"><span data-stu-id="44a6d-118">**Invoice Run Date**: This date is dictated by the invoice frequency.</span></span>
    - <span data-ttu-id="44a6d-119">**交易截止日期**：发票运行日期的前一天。</span><span class="sxs-lookup"><span data-stu-id="44a6d-119">**Transaction Cutoff Date**: The day before the invoice run date.</span></span>
    - <span data-ttu-id="44a6d-120">**运行状态**：自动设置为 **未运行**。</span><span class="sxs-lookup"><span data-stu-id="44a6d-120">**Run Status**: Automatically set to **Not Run**.</span></span> <span data-ttu-id="44a6d-121">当自动发票创建作业在某个发票运行日期运行时，此字段将更新为 **运行成功** 或 **运行失败**。</span><span class="sxs-lookup"><span data-stu-id="44a6d-121">When the automatic invoice creation job runs for a certain invoice run date, this field is updated to **Run Successful** or **Run Failed**.</span></span>

## <a name="create-a-fixed-price-invoice-schedule-for-a-contract-line"></a><span data-ttu-id="44a6d-122">为合同子项创建固定价格发票计划</span><span class="sxs-lookup"><span data-stu-id="44a6d-122">Create a fixed price invoice schedule for a contract line</span></span>

<span data-ttu-id="44a6d-123">当合同子项具有固定计费方法时，您可以创建基于里程碑的发票计划。</span><span class="sxs-lookup"><span data-stu-id="44a6d-123">When the contract line has a fixed billing method, you can create a milestone-based invoice schedule.</span></span> 

> [!NOTE]
> <span data-ttu-id="44a6d-124">如果没有项目映射到合同子项，将无法在合同子项上创建里程碑。</span><span class="sxs-lookup"><span data-stu-id="44a6d-124">Milestones can't be created on a contract line if there is no project mapped to the contract line.</span></span>

<span data-ttu-id="44a6d-125">完成以下步骤，为日历期间内平均分配的一组固定里程碑生成基于里程碑的发票计划。</span><span class="sxs-lookup"><span data-stu-id="44a6d-125">Complete the following steps to generate a milestone-based invoice schedule for a fixed set of equally distributed milestones for the calendar period.</span></span>

1. <span data-ttu-id="44a6d-126">转到 **设置** > **发票频率**，设置发票频率。</span><span class="sxs-lookup"><span data-stu-id="44a6d-126">Go to **Settings** > **Invoice frequencies** and set up an invoice frequence.</span></span>
2. <span data-ttu-id="44a6d-127">转到项目合同记录，在 **摘要** 选项卡上的 **要求交货日期** 字段中，选择日期。</span><span class="sxs-lookup"><span data-stu-id="44a6d-127">Go to the project contract record, and on the **Summary** tab, in the **Requested Delivery Date** field, select a date.</span></span>
3. <span data-ttu-id="44a6d-128">打开您要为其创建里程碑计划的 **固定价格** 合同子项。</span><span class="sxs-lookup"><span data-stu-id="44a6d-128">Open the **Fixed Price** contract line that you are creating the milestone schedule for.</span></span> <span data-ttu-id="44a6d-129">在 **记帐里程碑** 选项卡上，选择记帐开始日期和发票频率。</span><span class="sxs-lookup"><span data-stu-id="44a6d-129">On the **Billing Milestones** tab, select the billing start date and the invoice frequency.</span></span> 
4. <span data-ttu-id="44a6d-130">在子网格上，选择 **生成定期里程碑**。</span><span class="sxs-lookup"><span data-stu-id="44a6d-130">On the subgrid, select **Generate Periodic Milestones**.</span></span> <span data-ttu-id="44a6d-131">发票计划将生成，并按照以下方式设置 **里程碑名称**、**里程碑日期** 和 **里程碑金额** 字段：</span><span class="sxs-lookup"><span data-stu-id="44a6d-131">The  invoice schedule is generated with the **Milestone Name**, **Milestone Date**, and **Milestone Amount** fields set as follows:</span></span>

    - <span data-ttu-id="44a6d-132">**里程碑** 名称：此名称由发票频率决定。</span><span class="sxs-lookup"><span data-stu-id="44a6d-132">**Milestone Name**: This name is dictated by the invoice frequency.</span></span>
    - <span data-ttu-id="44a6d-133">**里程碑日期**：此日期由发票频率指示。</span><span class="sxs-lookup"><span data-stu-id="44a6d-133">**Milestone Date**: This date is dictated by the invoice frequency.</span></span>
    - <span data-ttu-id="44a6d-134">**里程碑金额**：此金额通过将合同子项上的合同金额除以里程碑数量计算得出，由频率、记帐开始日期和要求交货日期指示。</span><span class="sxs-lookup"><span data-stu-id="44a6d-134">**Milestone Amount**: This amount is calculated by dividing the contract amount on the contract line by the number of milestones as dictated by the frequency, billing start, and requested delivery dates.</span></span>

    <span data-ttu-id="44a6d-135">如果合同子项在 **估算税额** 字段中有值，那么在生成定期里程碑时，此字段也会平均分配给每个里程碑。</span><span class="sxs-lookup"><span data-stu-id="44a6d-135">If the contract line has a value in the **Estimated Tax amount** field, then this field is also apportioned to each milestone equally when generating periodic milestones.</span></span>

<span data-ttu-id="44a6d-136">记帐里程碑应该等于合同子项的合同值。</span><span class="sxs-lookup"><span data-stu-id="44a6d-136">Billing milestones should equal the contracted value of the contract line.</span></span> <span data-ttu-id="44a6d-137">如果不等于，您将在 **合同子项** 页上收到错误。</span><span class="sxs-lookup"><span data-stu-id="44a6d-137">If they don't, you will receive an  error on the **Contract Line** page.</span></span> <span data-ttu-id="44a6d-138">您可以通过创建、编辑或删除里程碑来验证记帐里程碑是否是合同值的总计来解决错误。</span><span class="sxs-lookup"><span data-stu-id="44a6d-138">You can fix the error by verifying that the billing milestones total the contracted value of the line by creating, editing, or deleting milestones.</span></span> <span data-ttu-id="44a6d-139">进行更改后，刷新页面来清除错误。</span><span class="sxs-lookup"><span data-stu-id="44a6d-139">After the changes are made, refresh the page to remove the error.</span></span>

### <a name="manually-create-milestones"></a><span data-ttu-id="44a6d-140">手动创建里程碑</span><span class="sxs-lookup"><span data-stu-id="44a6d-140">Manually create milestones</span></span>

<span data-ttu-id="44a6d-141">您可以在不定期拆分固定价格里程碑时手动生成这些里程碑。</span><span class="sxs-lookup"><span data-stu-id="44a6d-141">You can generate fixed price milestones manually when they are not periodically split.</span></span> <span data-ttu-id="44a6d-142">完成以下步骤来手动创建里程碑。</span><span class="sxs-lookup"><span data-stu-id="44a6d-142">Complete the following steps to manually create a milestone.</span></span>

1. <span data-ttu-id="44a6d-143">打开您要为其创建里程碑的固定价格合同子项，在子网格上的 **发票计划** 选项卡上，选择 **+ 创建新合同子项里程碑**。</span><span class="sxs-lookup"><span data-stu-id="44a6d-143">Open the fixed price contract line that you are creating a milestone for, and on the **Invoice Schedule** tab, on the subgrid, select **+ Create new Contract line milestone**.</span></span> 
2. <span data-ttu-id="44a6d-144">在 **里程碑创建** 页上，根据下表输入所需信息。</span><span class="sxs-lookup"><span data-stu-id="44a6d-144">On the **Milestone Creation** page, enter the required information based on the following table.</span></span>

| <span data-ttu-id="44a6d-145">字段</span><span class="sxs-lookup"><span data-stu-id="44a6d-145">Field</span></span> | <span data-ttu-id="44a6d-146">地点</span><span class="sxs-lookup"><span data-stu-id="44a6d-146">Location</span></span> | <span data-ttu-id="44a6d-147">描述</span><span class="sxs-lookup"><span data-stu-id="44a6d-147">Description</span></span> | <span data-ttu-id="44a6d-148">下游影响</span><span class="sxs-lookup"><span data-stu-id="44a6d-148">Downstream impact</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="44a6d-149">里程碑名称</span><span class="sxs-lookup"><span data-stu-id="44a6d-149">Milestone Name</span></span> | <span data-ttu-id="44a6d-150">快速创建</span><span class="sxs-lookup"><span data-stu-id="44a6d-150">Quick Create</span></span> | <span data-ttu-id="44a6d-151">里程碑名称的文本字段。</span><span class="sxs-lookup"><span data-stu-id="44a6d-151">Text field for the name of the milestone.</span></span> | <span data-ttu-id="44a6d-152">此字段将转到项目合同子项里程碑和发票。</span><span class="sxs-lookup"><span data-stu-id="44a6d-152">This is carried over to the project contract line milestone and the invoice.</span></span> |
| <span data-ttu-id="44a6d-153">项目任务</span><span class="sxs-lookup"><span data-stu-id="44a6d-153">Project Task</span></span> | <span data-ttu-id="44a6d-154">快速创建</span><span class="sxs-lookup"><span data-stu-id="44a6d-154">Quick Create</span></span> | <span data-ttu-id="44a6d-155">如果里程碑与项目任务相关联，使用此引用来添加自定义逻辑，以根据任务状态设置里程碑状态。</span><span class="sxs-lookup"><span data-stu-id="44a6d-155">If the milestone is tied to project task, use this reference to add custom logic to set the milestone status based on the task status.</span></span> | <span data-ttu-id="44a6d-156">应用程序不会对此任务引用产生任何下游影响。</span><span class="sxs-lookup"><span data-stu-id="44a6d-156">The application, doesn't have any downstream impact of this reference to a task.</span></span> |
| <span data-ttu-id="44a6d-157">里程碑日期</span><span class="sxs-lookup"><span data-stu-id="44a6d-157">Milestone Date</span></span> | <span data-ttu-id="44a6d-158">快速创建</span><span class="sxs-lookup"><span data-stu-id="44a6d-158">Quick Create</span></span> | <span data-ttu-id="44a6d-159">设置自动发票创建流程应查找此里程碑的状态以考虑将其用于开票的日期。</span><span class="sxs-lookup"><span data-stu-id="44a6d-159">Set the date on which the automatic invoice creation process should look for the status of this milestone to consider it for invoicing.</span></span> | <span data-ttu-id="44a6d-160">此字段将转到项目合同子项里程碑和发票。</span><span class="sxs-lookup"><span data-stu-id="44a6d-160">This is carried over to the project contract line milestone and the invoice.</span></span> |
| <span data-ttu-id="44a6d-161">账单状态</span><span class="sxs-lookup"><span data-stu-id="44a6d-161">Invoice Status</span></span> | <span data-ttu-id="44a6d-162">快速创建</span><span class="sxs-lookup"><span data-stu-id="44a6d-162">Quick Create</span></span> | <span data-ttu-id="44a6d-163">创建里程碑时，此状态始终设置为 **未准备好开发票** 或 **未开始**。</span><span class="sxs-lookup"><span data-stu-id="44a6d-163">When a milestone is created, this status is always set to **Not Ready for Invoicing** or **Not Started**.</span></span> | <span data-ttu-id="44a6d-164">此字段将转到项目合同子项里程碑和发票。</span><span class="sxs-lookup"><span data-stu-id="44a6d-164">This is carried over to the project contract line milestone and the invoice.</span></span> |
| <span data-ttu-id="44a6d-165">明细金额</span><span class="sxs-lookup"><span data-stu-id="44a6d-165">Line Amount</span></span> | <span data-ttu-id="44a6d-166">快速创建</span><span class="sxs-lookup"><span data-stu-id="44a6d-166">Quick Create</span></span> | <span data-ttu-id="44a6d-167">将为客户开票的里程碑的金额或值。</span><span class="sxs-lookup"><span data-stu-id="44a6d-167">Amount or value of the milestone that will be invoiced to the customer.</span></span> | <span data-ttu-id="44a6d-168">此字段将转到项目合同子项里程碑和发票。</span><span class="sxs-lookup"><span data-stu-id="44a6d-168">This is carried over to the project contract line milestone and the invoice.</span></span> |
| <span data-ttu-id="44a6d-169">税款</span><span class="sxs-lookup"><span data-stu-id="44a6d-169">Tax</span></span> | <span data-ttu-id="44a6d-170">快速创建</span><span class="sxs-lookup"><span data-stu-id="44a6d-170">Quick Create</span></span> | <span data-ttu-id="44a6d-171">里程碑上应用的税额。</span><span class="sxs-lookup"><span data-stu-id="44a6d-171">The tax amount applied on the milestone.</span></span> | <span data-ttu-id="44a6d-172">此字段将转到项目合同子项里程碑和发票。</span><span class="sxs-lookup"><span data-stu-id="44a6d-172">This is carried over to the project contract line milestone and the invoice.</span></span> |

3. <span data-ttu-id="44a6d-173">选择 **保存并关闭**。</span><span class="sxs-lookup"><span data-stu-id="44a6d-173">Select **Save and Close**.</span></span>
