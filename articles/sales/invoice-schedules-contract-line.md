---
title: 根据基于项目的合同子项创建账单计划
description: 此主题提供有关如何在合同子项上创建发票计划和里程碑的信息。
author: rumant
ms.date: 10/17/2020
ms.topic: article
ms.reviewer: johnmichalak
ms.author: rumant
ms.openlocfilehash: 7dd8e4517d5ae7401fd0f11301943157b42a6b0e
ms.sourcegitcommit: c0792bd65d92db25e0e8864879a19c4b93efb10c
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2022
ms.locfileid: "8595211"
---
# <a name="create-an-invoice-schedule-on-a-project-based-contract-line"></a>根据基于项目的合同子项创建账单计划 

_**适用于：** 面向资源/非库存场景的 Project Operations_

您可以为基于项目的合同子项创建发票计划。 仅在合同赢单并且您在创建项目合同之后才允许开票。 通过发票计划，可以为基于项目的合同子项自动创建草稿发票。 不过，如果您只手动创建发票，则可以跳过在合同子项上创建发票计划。

## <a name="create-a-time-and-material-invoice-schedule-for-a-contract-line"></a>为合同子项创建时间和材料发票计划

当基于项目的合同子项使用时间和材料计费方法时，您可以创建基于日期的发票计划。 若要自动生成基于日期的发票计划，请完成以下步骤。

1. 转到 **设置** > **发票频率**，设置发票频率。
2. 转到项目合同记录，在 **摘要** 选项卡上的 **要求交货日期** 字段中，选择日期。
3. 打开您要为其创建基于日期的发票计划的 **时间和材料** 合同子项。 
4. 在 **发票计划** 选项卡上，选择记帐开始日期和发票频率。
5. 在子网格上，选择 **生成发票计划**。 发票计划将生成，并按照以下方式设置 **发票运行日期**、**交易截止日期** 和 **运行状态** 字段：

    - **发票运行日期**：此日期由发票频率指示。
    - **交易截止日期**：发票运行日期的前一天。
    - **运行状态**：自动设置为 **未运行**。 当自动发票创建作业在某个发票运行日期运行时，此字段将更新为 **运行成功** 或 **运行失败**。

## <a name="create-a-fixed-price-invoice-schedule-for-a-contract-line"></a>为合同子项创建固定价格发票计划

当合同子项具有固定计费方法时，您可以创建基于里程碑的发票计划。 

> [!NOTE]
> 如果没有项目映射到合同子项，将无法在合同子项上创建里程碑。

完成以下步骤，为日历期间内平均分配的一组固定里程碑生成基于里程碑的发票计划。

1. 转到 **设置** > **发票频率**，设置发票频率。
2. 转到项目合同记录，在 **摘要** 选项卡上的 **要求交货日期** 字段中，选择日期。
3. 打开您要为其创建里程碑计划的 **固定价格** 合同子项。 在 **记帐里程碑** 选项卡上，选择记帐开始日期和发票频率。 
4. 在子网格上，选择 **生成定期里程碑**。 发票计划将生成，并按照以下方式设置 **里程碑名称**、**里程碑日期** 和 **里程碑金额** 字段：

    - **里程碑** 名称：此名称由发票频率决定。
    - **里程碑日期**：此日期由发票频率指示。
    - **里程碑金额**：此金额通过将合同子项上的合同金额除以里程碑数量计算得出，由频率、记帐开始日期和要求交货日期指示。

    如果合同子项在 **估算税额** 字段中有值，那么在生成定期里程碑时，此字段也会平均分配给每个里程碑。

记帐里程碑应该等于合同子项的合同值。 如果不等于，您将在 **合同子项** 页上收到错误。 您可以通过创建、编辑或删除里程碑来验证记帐里程碑是否是合同值的总计来解决错误。 进行更改后，刷新页面来清除错误。

### <a name="manually-create-milestones"></a>手动创建里程碑

您可以在不定期拆分固定价格里程碑时手动生成这些里程碑。 完成以下步骤来手动创建里程碑。

1. 打开您要为其创建里程碑的固定价格合同子项，在子网格上的 **发票计划** 选项卡上，选择 **+ 创建新合同子项里程碑**。 
2. 在 **里程碑创建** 页上，根据下表输入所需信息。

| 字段 | 地点 | 描述 | 下游影响 |
| --- | --- | --- | --- |
| 里程碑名称 | 快速创建 | 里程碑名称的文本字段。 | 此字段将转到项目合同子项里程碑和发票。 |
| 项目任务 | 快速创建 | 如果里程碑与项目任务相关联，使用此引用来添加自定义逻辑，以根据任务状态设置里程碑状态。 | 应用程序不会对此任务引用产生任何下游影响。 |
| 里程碑日期 | 快速创建 | 设置自动发票创建流程应查找此里程碑的状态以考虑将其用于开票的日期。 | 此字段将转到项目合同子项里程碑和发票。 |
| 账单状态 | 快速创建 | 创建里程碑时，此状态始终设置为 **未准备好开发票** 或 **未开始**。 | 此字段将转到项目合同子项里程碑和发票。 |
| 明细金额 | 快速创建 | 将为客户开票的里程碑的金额或值。 | 此字段将转到项目合同子项里程碑和发票。 |
| 税款 | 快速创建 | 里程碑上应用的税额。 | 此字段将转到项目合同子项里程碑和发票。 |

3. 选择 **保存并关闭**。


[!INCLUDE[footer-include](../includes/footer-banner.md)]