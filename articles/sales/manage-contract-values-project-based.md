---
title: 处理基于项目的合同子项
description: 此主题提供有关基于项目的合同子项的信息。
author: rumant
manager: Annbe
ms.date: 10/28/2020
ms.topic: article
ms.service: project-operations
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 14d880eccd5547c122ebe37b63022e64fa2fb6fe
ms.sourcegitcommit: f6f86e80dfef15a7b5f9174b55dddf410522f7c8
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/31/2020
ms.locfileid: "4181697"
---
# <a name="work-with-projectbased-contract-lines"></a>处理基于项目的合同子项

Dynamics 365 Project Operations 中的基于项目的合同子项用于保留参与项目中项目工作特定组成部分的估算和计费协议。 基于项目的合同子项的结构已针对存在以下概念的项目估算和计费方案扩展：

- 计费方法
- 项目和任务映射
- 包括的交易类
- 上限
- 应计费设置
- 使用合同子项详细信息估算
- 合同子项客户

基于项目的合同子项的 **常规** 选项卡中包含以下字段。 这些字段帮助为基于项目的工作设定详细的基础估算和计费安排的基础。

| 字段 | 描述 | 下游影响 |
| --- | --- | --- |
| **客户** | 标识正在估算的合同的独立部分的合同子项的名称。 对于从报价单创建的项目合同，从基于项目的报价单明细的相应值复制此值。 | 此字段将在创建发票时复制到从此合同子项创建的项目发票明细中。 |
| **记帐方法** | 在从报价单创建的项目合同上，从报价单明细上的相应字段复制此值。 这是一个选项集，代表 Project Operations 支持的两个主要合同签订模型：</br>- **固定价格**</br>- **时间和材料** | 根据引用的合同子项的计费方法，将处理实际交易。 如果实际值引用的合同子项具有时间和材料计费方法，将创建成本和未记帐实际销售额记录。 如果实际值引用的合同子项具有固定价格计费方法，将仅创建成本实际值。 |
| **Project** | 使用此字段来标识将用于交付此参与项目中的工作的项目。 | 此字段中的值将与 **包含的任务** 和 **包含的交易类** 字段结合使用，来解析实际或估算明细记录中的合同子项引用。 |
| **包括时间** | 指示所选项目中的时间交易或人工成本是否将包括在此合同子项中的标志。 **否** 值指示时间交易或人工成本将不包括在此合同子项中。 **是** 值指示包括。 | 此字段值与项目结合使用，来解析实际或估算明细记录中的合同子项引用。 |
| **包括支出** | 指示所选项目中的支出成本是否将包括在此合同子项中的标志。 **否** 值指示支出成本将不包括在此合同子项中。 **是** 值指示包括。 | 此字段值与项目结合使用，来解析实际或估算明细记录中的合同子项引用。 |
| **包括费用** | 指示所选项目中的费用是否将包括在此合同子项中的标志。 **否** 值指示费用将不包括在此合同子项中。 **是** 值指示包括。 | 此字段值与项目结合使用，来解析实际或估算明细记录中的合同子项引用。 |
| **合同金额** | 在固定价格合同子项上，此值是将为与此合同子项关联的所有工作组成部分向客户开票的商定值。 在时间和材料合同子项上，此金额是将为与此合同子项关联的所有工作组成部分向客户开票的估计值。 在从报价单创建的项目合同上，从报价单明细上的相应字段复制此值。 当基于项目的合同子项具有明细详细信息时，此字段将被锁定以进行编辑，值从合同子项详细信息中的金额汇总得出。 | 当合同子项具有明细详细信息时，可以通过更改明细详细信息中的金额来修改此值。 在固定价格合同子项中，此值用于生成定期计费里程碑上的税前金额。 |
| **预计税款** | 用户可以编辑此字段来在合同子项上输入估算税额。 当基于项目的合同子项具有明细详细信息时，此字段将被锁定以进行编辑，值从合同子项详细信息中的税额汇总得出。 | 当合同子项具有明细详细信息时，可以通过更改明细详细信息中的税额来修改此值。 在固定价格合同子项中，此值用于生成定期计费里程碑上的税款。 |
| **税后合同金额** | 税后合同子项金额。 此字段为只读字段，计算公式为 **合同金额 + 税款**。 | 在固定价格合同子项中，此值用于生成定期计费里程碑。 |
| **上限** | 用户可以编辑此字段，它仅在具有时间和材料计费方法的基于项目的合同子项上可用。 | 用户可以编辑此字段。 当时间或支出实际值引用此合同子项以获取时间和材料值时，实际值中的金额将在计入已花费和提交的金额后根据此合同子项中的上限计算。 |
| **客户预算** | 如果合同是从报价单创建的，此字段可以编辑，值从报价单明细上的相应字段复制。 | 此字段仅用于提供信息，对下游没有任何意义。 |

## <a name="validation-rule-for-the-options-on-the-general-tab-of-project-based-contract-lines"></a>基于项目的合同子项的“常规”选项卡上选项的验证规则

规则：一个项目和一个特定交易类只能包含在合同中一个基于项目的合同子项上。

| 合同 | 合同子项 | Project | 包括时间 | 包括支出 | 包括费用 | 有效/无效 | 原因                                                                                                                                                                                                  |
|----------|---------------|---------|--------------|-----------------|-------------|-----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| C1       | CL1           | P1      | 是          | 是             | 是         | 无效       | 违反规则。 项目 P1 上的时间、支出和费用可同时包含在合同子项 CL1 和 CL2 中。                                                                                       |
| C1       | CL2           | P1      | 是          | 是             | 是         | 无效       | 违反规则。 项目 P1 上的时间、支出和费用可同时包含在合同子项 CL1 和 CL2 中。                                                                                       |
| C1       | CL1           | P1      | 是          | No              | 是         | 无效       | 违反规则。 项目 P1 上的时间和费用可同时包含在合同子项 CL1 和 CL2 中。                                                                                                   |
| C1       | CL2           | P1      | 是          | 是             | 是         | 无效       | 违反规则。 项目 P1 上的时间和费用可同时包含在合同子项 CL1 和 CL2 中。                                                                                                   |
| C1       | CL1           | P1      | 是          | No              | 是         | 有效           | 项目 P1 上的时间和费用包含在 CL1 中。 项目 P1 上的支出包含在 CL2 中。 </br>   每个合同子项中包含的内容没有重叠，因此是有效的。  |
| C1       | CL2           | P1      | No           | 是             | No          | 有效           | 项目 P1 上的时间和费用包含在 CL1 中。 项目 P1 上的支出包含在 CL2 中。 </br>   每个合同子项中包含的内容没有重叠，因此是有效的。  |
| C1       | CL1           | P1      | 是          | 是             | 是         | 无效       | 违反规则。 项目 P1 上的时间、支出和费用可包含在两个合同的子项中。                                                                                               |
| CL2      | CL2           | P1      | 是          | 是             | 是         | 无效       | 违反规则。 项目 P1 上的时间、支出和费用可包含在两个合同的子项中。                                                                                               |
