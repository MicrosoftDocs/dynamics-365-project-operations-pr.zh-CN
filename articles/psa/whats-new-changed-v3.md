---
title: Project Service Automation 版本 3 中的新增功能或更改
description: 本主题介绍 Project Service Automation 版本 3 中的新增功能和更改。
manager: kfend
ms.service: project-operations
ms.custom:
- dyn365-projectservice
ms.date: 11/28/2018
ms.topic: article
author: JohnPBurrows
ms.author: rumant
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365CE
- D365PS
- ProjectOperations
ms.openlocfilehash: 46cbbc3ff3b0efcecd3cba30b265a782f6cdcf60
ms.sourcegitcommit: 4cf1dc1561b92fca4175f0b3813133c5e63ce8e6
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/28/2020
ms.locfileid: "4119992"
---
# <a name="whats-new-or-changed-in-project-service-automation-version-3"></a>Project Service Automation 版本 3 中的新增功能或更改
[!INCLUDE[cc-applies-to-psa-app-1x-2x](../includes/cc-applies-to-psa-app-1x-2x.md)]

本主题介绍 Project Service Automation 版本 2 或版本 1 与 3 之间用户界面 (UI)、功能和术语的变化。

## <a name="project-scheduling"></a>项目计划编制
项目计划在早期版本中称为工作分解结构 (WBS)，已经重命名为“计划”，可以通过单击 **计划** 选项卡访问。 

![项目计划](media/psa-schedule-01.png)

计划现在为交互采用了新的界面，该界面既现代，又容易访问。 但是基础 Project Service Automation 计划引擎未变。 和 Project Service Automation 的上一个版本一样，可使用计划网格功能区中的控件按钮与计划交互。 计划的其他更改包括：

- **甘特图** - 不再提供甘特图。 在以后的更新中，新甘特图可视化对象将回归。
- **列标题** - 可通过单击列标题旁边的向下指示器在网格中隐藏列标题。 
- **列** - 可通过单击 **添加列** 显示隐藏的列。 
- **交易类别** - 已在计划网格中增加了 **交易类别** 查找，并默认显示。 
 
## <a name="project-templates"></a>项目模板
已对项目模板功能进行了以下更改。

### <a name="create-a-project-template"></a>创建项目模板 
和 Project Service Automation 早期版本一样，可以在版本 3 中创建项目模板。 模板中只能包含一个计划，而该计划中可以包含分派，但不是必须包含。 如果计划中没有分派，说明分派仅适用于通用资源。 可以为通用资源生成资源要求，但是不能在模板中为这些要求预订实际资源。 不能在模板中为团队预订实际资源。 

### <a name="create-a-template-from-an-existing-template"></a>根据现有模板创建模板
在 Project Service Automation 版本 3 中根据现有模板创建新项目模板时，将出现以下情况： 

- 源项目的计划复制到模板中。 
- 通用资源复制到团队中，并覆盖所有通用资源分派。 不覆盖通用资源的要求。 

### <a name="create-a-template-from-an-existing-project"></a>根据现有项目创建模板
根据需要项目创建新项目模板时，将出现以下情况： 

- 源项目的计划复制到模板中。 
- 通用资源复制到团队中，并保留所有通用资源分派。 不覆盖通用资源的要求。    
- 从团队中删除指定资源（已分派资源和未分派资源），并替换为通用资源。
- 删除客户信息（如果有）。 
- 删除对报价单和合同的引用（如果有）。 

### <a name="create-a-project-from-a-template"></a>从模板创建项目
在 Project Service Automation 版本 3 中根据模板创建新项目时，将出现以下情况：

- 计划、团队和分派复制到新项目。   
- 开始日期为复制日期或用户选择的日期。   
- 对于模板中具有资源要求的所有通用团队成员，不自动复制或生成要求。 需要由您生成。 

## <a name="copy-a-project"></a>复制项目
在 Project Service Automation 版本 3 中复制项目时，将出现以下情况： 

- 复制，但可以更改估算开始日期。  
- 复制项目计划和任务。 
- 复制通用资源及其分派。 不复制通用资源的资源要求。 需要由您重新生成。 
- 不复制实际资源及其分派。 而是将其替换为通用资源。 
- 不将实际值复制到新项目。 

## <a name="move-a-scheduled-project"></a>移动计划的项目
向前移动现有项目的计划时，将出现以下情况： 

- 自动移动任务日期以便与移动期间对应。 
- 已分派通用资源保持分派状态。   
- 如果是在移动项目之前生成的，则通用资源的要求不变，不会自动重新生成。 您需要再次生成，以体现任务移动造成的新分派。 
- 对实际资源的分派将更改，以便与任务日期移动对应。 对实际资源的订阅不变。 您需要使用协调视图修改预订。 
- 具有预订，但是不具有分派的团队资源不变。 
- 实际值不移动。 

## <a name="estimates"></a>估算
估算已拆分为两个选项卡：**资源分派** 和 **估算**。 **资源分派** 选项卡中包含工作量估算，并通过分时段视图显示任务的资源分派。 可根据计划引擎生成的结果编辑估算。

![“资源分派”选项卡显示任务的工作量估算和资源分派](media/resource-assignments-tab-02.png)

**估算** 选项卡显示资源分派的成本和销售额。 这些金额为只读。 定成本和销售定价现在通过计划中的团队成员分派驱动。 这表示如果任务没有分派，将在未分派桶下显示。 还表示如果没有 **角色**（这是默认定价维度），如果您为项目关联客户或合同/报价单，则不存在估算成本或销售额。 

![“估算”选项卡显示成本和销售额](media/estimates-tab-03.png)
  
在计划视图中，任务还支持类别。 如果在估算的分时段视图中按类别分组，则体验更好，特别是当您的项目中还有支出估算时。 支出估算使用单独选项卡中的网格输入。 

可以在 **支出估算** 选项卡上的网格中输入支出估算。 

![“支出估算”选项卡显示支出估算网格](media/expense-estimates-tab-04.png)

## <a name="resource-management"></a>资源管理
在 Project Service Automation 版本 3 中，由于采用了新的统一客户端 UI，并且对预订与分派之间的关系进行了更改，所以使用通用资源或实际资源为项目安排人员的方法与版本 2 和版本 1 差别很大。 但是可预订资源（**实际** 资源和 **通用** 资源）的概念未变，团队成员、要求、分派和预订的概念也未变。   

![使用资源选取器](media/resource-management-05.png)

### <a name="assign-a-real-bookable-resource"></a>分派实际可预订资源 
在 Project Service Automation 版本 3 中，预订与任务分派之间的联系不如在 Project Service Automation 早期版本中紧密。 可以使用团队网格预订 **实际** 团队成员，就像在市场内一样。

可使用计划中的资源选取器选择在团队视图中创建的团队成员，然后将其分派给任务。 可以继续为其分派任务，即使已经通过了预订。 可使用 **协调** 选项卡协调在预订和分派中存在差异的团队成员。

资源选取器将显示项目的团队成员。 也可以使用资源选取器搜索和查看不属于项目团队的其他可预订资源。 可以将其分派给任务，这样它们就成为了项目团队的一部分。 您需要使用 **日程安排板** 或 **协调** 选项卡协调它们。

### <a name="assign-a-generic-bookable-resource-on-a-task-and-project-team-and-then-fulfill-with-a-real-resource-via-schedule-board"></a>通过日程安排板为任务分派通用可预订资源和使用实际资源完成任务 
在 Project Service Automation 版本 3 中，生成团队功能不适用于通用资源。 您可以改为通过在计划的资源单元格中键入通用资源的位置名称，从计划创建并直接分派通用资源。 也可以在单元格中选择资源图标，然后使用资源选取器键入要创建的通用资源的名称。 这样将打开快速创建面板，供您设置通用资源团队成员的角色和部门。 创建资源后，将把该资源分派给任务，而您可以继续把该通用资源分派给计划中的其他任务。    
 
将资源分派给所有适当任务之后，可以生成资源要求，然后通过使用 **日程安排板** 直接预订或通过提交资源请求来满足要求。 也可以直接向团队成员网格添加通用资源。 

将把通用资源添加到项目团队，但不带资源要求，不过具有项目开始/结束日期，直到生成资源要求。 若要生成要求，请选择通用资源，然后单击 **生成**。 现在将显示要求链接，并使用分派的工时填充所需工时。 可单击此链接打开和更新要求。
  
当预订完成并由指定资源完全履行时，将把通用资源替换为该指定资源，并使用该指定资源更新计划中的分派。 

要求的建议资源现在存储在选项卡中，而不是存储在单独的部分中。

### <a name="multiple-named-resources-fulfilling-a-generic-resource"></a>多个指定资源替代一个通用资源
当使用多个资源满足一项要求时，通用资源仍然留在团队中，并继续分派给任务。 位置中不会分派已预订的指定团队成员。 项目经理可以根据需要将工作分派给实际资源。  **协调** 视图提供多个资源到多个任务分派的预订分解。 不会自动执行此操作，因为在复杂的方案中（如您有大量任务构成要求），需要假设项目经理的分派方法意图。 因为系统无法理解意图，所以假设可能与意图不同，并且可能会出现错误结果或不可预料的结果。 可预测结果是项目经理特意使用 **协调** 视图分派资源之前，一直使用分派的通用资源。

### <a name="reconciliation"></a>协调
**协调** 选项卡显示每个项目团队成员的预订和所有分派。 此视图通过单元格显示可表示时间点（从数月到数天）的工时。 项目经理可通过此视图协调其项目团队的团队成员预订及其分派。 这非常有用，因为预订之间的关系不紧密，所以规划项目时更灵活。 

![协调选项卡显示项目团队成员的预订和分派](media/resource-reconciliation-tab-06.png)

对于每个资源，视图显示团队成员的预订与其任务分派汇总之间的区别，并显示项目中的预订和分派之间可能出现的两项差别： 

- **预订不足** - 资源的分派比预订的多时，会发生预订不足。 因为尚未保留此产能，所以项目经理可以解决这个问题，方法是扩展资源的预订以弥补不足额。 
- **超出预订** - 当已经将某个资源预订给项目，但是尚未将其分派给任务时，发生超出预订。  可能可以接受这种现象，例如，资源在任务分派前预订。 但是在其他情况下，可能未计划分派资源，并且 PM 应该考虑取消资源的预订以留出产能用于其他项目。 

如果资源有任务分派，但是无预订（预订不足），可以选择聚合预订不足，然后单击 **扩展预订**。 可在此处查看解决资源不足和资源可用性所需预订。 
 
## <a name="time-and-expense"></a>时间和支出
此部分介绍 Project Service Automation 版本 3 中时间、支出和审批方面的改变。 在 Dynamics 365 Project Service Automation 解决方案中，**时间条目** 功能已更新，现在利用统一接口框架。 因此提供了一致、统一的用户界面，该界面采用了响应式设计，非常适合在任何屏幕尺寸或设备上查看。 

### <a name="landing-page"></a>登陆页
版本 3 中已弃用了不可扩展的自定义时间条目体验。 而是现在提供可扩展、可访问的本机网格体验。 可使用左侧的站点地图访问时间条目功能。 由于此项更改，您不再可以一次性输入一周的时间。 相反，您需要在网格中为每天创建一个时间条目。 创建一些时间条目之后，用户可以使用本主题后文介绍的 **复制功能** 批量创建时间条目。 

![时间条目登陆页](media/time-entry-landing-page-07.png)
 
### <a name="create-new-time-entries"></a>创建新的时间条目 
单击功能区中的 **新建** 打开时间条目的快速创建页面，可在其中输入以分钟、小时或天为单位的持续时间。 要输入，只需开始键入 h、m 或 d 和数量。  

![时间条目快速创建](media/quick-create-time-entry-08.png)

查找字段受系统视图支持。 例如，输入项目信息之后，**项目任务** 字段默认设置为 **我已开启的项目任务** 视图。 若要为尚未分派给用户的任务创建时间条目，请在查找中单击 **更改视图**，然后选择 **所有可用的项目任务**。 时间条目以创建并在网格中显示后，可以直接在网格中编辑任何明细值。  

### <a name="bulk-createcopy"></a>批量创建/复制 
创建一些时间条目之后，可以使用复制功能批量创建更多时间条目。 单击 **复制** 打开 **复制** 对话框。 在 **开始期间:开始日期** 中，设置必须从中复制时间段的日期范围。 在 **结束期间: 开始日期** 中，指定必须为其创建时间条目的日期。 单击 **复制** 将时间条目复制到 **结束期间** 中指定的相应星期几。 例如，将把上周星期一的时间条目复制到 **结束期间** 中指定的周的星期一。 

![批量复制时间条目](media/bulk-copy-time-entry-09.png)
 
### <a name="import-data"></a>导入数据 
分派和交换采用同一种 UI 模式，所以用户可以从需要导入预订的时间开始指定日期范围。 然后必须明确选择应该复制到 **草稿** 时间条目中的预订。 在版本 3 中，不再可以在网格和日历中查看 **建议** 时间条目的模式。  

### <a name="change-in-calendar-control"></a>日历控件中的更改
在版本 3 中，我们已放弃了自定义日历控件，现在使用 UC 日历显示周的时间条目。 可以使用此日历查看天、周和月。 

> [!NOTE]
> “日历”的限制是，该控件不支持对单个日历项执行操作。 例如，不能选择一个或多个日历项并提交或删除这些项。 单击日历项将打开 **时间条目实体** 页以提供更多操作。 

### <a name="extensibility"></a>扩展性
**仅捕获数据和支出条目实体中自定义字段内的数据** - 时间条目使用平台的可编辑网格、只读网格和日历控件。 所有这些控件都在本机中，因此支持自定义设置。 在 Project Service Automation 版本 3 中，可以添加更多自定义字段，设置查找字段和为其提供自定义视图支持。 也可以基于在自定义字段值中选择的值设置自定义业务逻辑。  

**捕获时间和支出条目中自定义字段内的数据并通过支持提交和审批流的实体传播** - 下图中显示对时间条目的典型处理。

![时间条目处理流](media/process-time-entries-10.png)

如果业务要求固定时间和支出实体必须捕获自定义定价维度，并通过上个图中的所有实体传播自定义定价维度中的时间和条目资源设置的值，请参阅[将自定义字段设置为定价维度](set-up-pricing-dimensions.md)

若要支持其中的时间和支出实体必须捕获自定义非定价维度并传播值的业务要求，可使用定价维度设置，并将自定义维度表示为不包含成本或帐单费率的定价维度。 另一个方案是，使用在所有实体内均相同的字段名向每个实体添加一个自定义字段。 可以创建自定义插件，以便关联参与使用交易源和交易连接实体的提交/审批流的实体中的记录。  

### <a name="delegate-time-and-expense-entry"></a>委派时间和支出条目
Common Data Service 平台不支持一位用户冒充另一位用户，这意味着在 Project Service Automation 版本 3 中，不支持委派时间和支出条目。 但是，合作伙伴和客户已通过解决办法在版本 3 中实现了对委派时间条目体验的支持。 这只是解决办法，不是完整解决方案，所以请务必了解限制，并且仅在可接受这些限制时使用这种办法。 

> [!IMPORTANT]
> 仅应将此信息视为针对合作伙伴/客户的自定义实施的建议指南。 产品团队不会通过我们的任何支持渠道提供对此功能的正式支持。

### <a name="customization-details"></a>自定义详细信息 
可通过自定义向创建和编辑体验添加 **可预订资源**，这样用户就可以充当代理，方法是把 **预订资源** 字段更改为需要记录其时间和支出条目的另一位用户。 以下步骤涵盖时间条目委派。 同样的信息也适用于支出条目委派。 
 
1.  确保委派用户拥有项目和项目任务的全局安全访问权限。 
1.  因为 **快速创建** 页面中不显示 **可预订资源**（这是 **时间条目** 实体中的一个字段），所以您需要添加该字段。

    - 或 -

    创建一个包含 **可预订资源** 列的自定义视图，以仅查看为资源创建的时间条目。 发布此视图的应用程序模块设计器中的自定义设置，使其在 **时间条目** 页的 **视图选择器** 下显示。 有两个插件可用于为非项目时间条目处理对经理的设置：

    - PreValidateTimeEntryCreate
    - PreValidateTimeEntryUpdate
 
1. 创建一个新插件以替换 **可预订资源** 字段中分派的用户的经理的 **经理** 字段。 使用与带外 (OOB) 插件（预验证）相同的 **执行阶段**，并使用比 OOB 插件更高（高于 1）的 **执行顺序**。 这将确保自定义插件在 OOB 插件后执行。  
 
### <a name="end-user-experience"></a>最终用户体验
1.  在快速创建页面中创建时间条目时，请输入项目和项目任务详细信息，然后在 **可预订资源** 字段中选择需要记录其时间条目的用户。 
2.  默认情况下，此字段默认采用已登录用户，但是假设该用户替换此字段，则现在为所选 **可预订资源** 创建时间条目。
3.  当您提交您为这些记录创建的时间条目时，这些条目将按照预期排队等待项目中的审批者。 
4.  如果您撤消为另一位用户创建的时间条目，这些时间条目的状态将恢复为 **草稿**，而 **可预订资源** 字段则设置为另一位用户。 
5.  （可选）您可以切换到自定义视图以筛选为另一位用户创建的时间条目。 
 
### <a name="limitations"></a>限制
只有已登录用户的上下文中才支持 **复制** 和 **导入** 功能。 这意味着不能导入为以可预订资源身份登录的用户创建的时间条目。

仅当完成了上面的 **自定义详细信息** 部分中的步骤 4，才会将不属于项目的时间条目传递给可预订资源的经理进行审批。 否则，将把另一位用户的非项目时间条目误传递给已登录用户的经理。 

### <a name="other-changes"></a>其他更改 
尚未移除 **预订和任务** 功能。 

## <a name="multidimensional-pricing"></a>多维定价
为了将灵活性发挥到极致，并满足不同的业务要求，Project Service Automation 版本 3 支持将定价维度集离散应用于成本和记帐费率。 可以将维度值设置为默认值，然后在定成本和定价流程中从资源分析传播到时间条目，再传播到项目实际值。 客户特定的配置和修改或扩展利用标准自定义基础结构。

Project Service Automation 随附了一组默认定价维度和角色与资源单位，并允许为每个角色和部门组合设置价格和成本。

对于希望在版本 3 中继续将这些现成字段用作定价维度的 Project Service Automation 客户，不会有任何明显变化。 可以继续正常使用 Project Service Automation。 但是，如果需要使用其他更多属性为资源定价或设置成本，可以使用版本 3 向 Project Service Automation 添加您自己的自定义定价维度。 自定义定价维度的扩展是非常复杂的配置体验。 

## <a name="quotes-and-contracts"></a>报价单和合同
在 Project Service Automation 版本 3 中，已改变了报价单和合同的各项设置和管理事项。 以下部分提供更详细的信息。

### <a name="set-up-chargeability-options"></a>设置应计费选项
在版本 1 和 2 中，特定报价单和合同的角色与类别应计费设置是使用报价单明细或合同子项顶部导航中的 **应计费** 视图完成的。 这里也是您为这些角色和支出类别设置价格的地方。

从版本 3 开始，角色和支出类别的应计费选项设置在报价单或合同子项级别进行。 定价设置与应计费设置分开。 不必使用顶部导航，即可在 **报价单明细** 和 **合同子项** 页中找到 **应计费角色** 和 **应计费类别**，形式为选项卡。

![应计费角色](media/chargeable-12.png)
 
应计费角色和应计费类别的设置也利用自带可编辑网格控件。 对于每个角色和类别，报价和合同签订阶段支持的记帐类型选项与之前版本一样，仍然是 **应计费** 和 **不应计费**。 报价和合同签订阶段不支持 **免费** 类型。 只有时间或支出审批期间才支持 **免费**。  
 
### <a name="create-and-edit-custom-pricing-for-a-project-service-automation-quote-and-project-contract"></a>为 Project Service Automation 报价单和项目合同创建和编辑自定义定价
在版本 1 和 2 中，对特定报价单和合同使用自定义价目表是使用 **应计费** 视图中的 **编辑价格** 进行的。 **应计费** 视图位于报价单明细或合同子项顶部导航中。 这里也是您为角色和支出类别设置应计费选项的地方。

从版本 3 开始，为 Project Service Automation 报价单和 Project Service Automation 项目合同创建和使用自定义项目价目表已经与应计费设置分开。 Project Service Automation 报价单和 Project Service Automation 项目合同具有一个称为 **项目价目表** 的新选项卡。 此选项卡显示附加到 Project Service Automation 报价单或项目合同的所有项目价目表的关联视图。 若要基于已经与项目报价单或合同关联的现有价目表创建自定义价目表，请单击 **创建自定义定价**。 这将为所有关联价目表创建一个副本，并将其附加到报价单或合同。 现在可打开价目表和编辑角色或支出类别价格，以便这些定价更改仅应用于此报价单或合同。 
  
下图显示创建自定义价目表之前的情况。

![自定义价目表之前](media/before-custom-price-lists-13.png)

下图显示创建自定义价目表之后的情况。

![自定义价目表之后](media/after-custom-price-lists-14.png)

> [!NOTE]
> 单击 **创建自定义定价** 到创建自定义价目表之间可能会短暂延迟。 建议刷新网格，而不是多次单击。 如果为关联的价目表名称附加了报价单名称或项目合同名称，说明已创建了自定义价目表。
