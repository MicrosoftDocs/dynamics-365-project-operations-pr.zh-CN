---
title: 向价格设置和交易实体添加自定义字段
description: 此主题介绍如何向价格设置和交易实体添加自定义字段。
author: Rumant
manager: kfend
ms.custom:
- dyn365-projectservice
ms.date: 10/01/2020
ms.topic: article
ms.service: business-applications
ms.author: rumant
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365PS
- ProjectOperations
ms.openlocfilehash: af2256e77c3ceeee9638f57d971137df1658687b
ms.sourcegitcommit: 418fa1fe9d605b8faccc2d5dee1b04b4e753f194
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/10/2021
ms.locfileid: "5148452"
---
# <a name="add-custom-fields-to-price-setup-and-transactional-entities"></a><span data-ttu-id="3dc2c-103">向价格设置和交易实体添加自定义字段</span><span class="sxs-lookup"><span data-stu-id="3dc2c-103">Add custom fields to price setup and transactional entities</span></span> 

[!include [banner](../includes/psa-now-project-operations.md)]

<span data-ttu-id="3dc2c-104">此主题假设您已完成了[创建自定义字段和实体](create-custom-fields-entities.md)主题中的过程。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-104">This topic assumes that you have completed the procedures in the topic, [Create custom fields and entities](create-custom-fields-entities.md).</span></span> <span data-ttu-id="3dc2c-105">如果尚未完成这些过程，请回去完成，然后回到此主题。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-105">If you haven't completed those procedures, go back and complete them and then return to this topic.</span></span> 

<span data-ttu-id="3dc2c-106">此主题中的过程将显示如何把所需自定义字段引用添加到实体和用户界面 (UI) 元素，如窗体和视图。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-106">In this topic, the procedures will show you how to add the required custom field references to entities and to the user interface (UI) elements such as forms and views.</span></span>

## <a name="add-custom-pricing-dimension-fields"></a><span data-ttu-id="3dc2c-107">添加自定义定价维度字段</span><span class="sxs-lookup"><span data-stu-id="3dc2c-107">Add custom pricing dimension fields</span></span> 
<span data-ttu-id="3dc2c-108">创建自定义字段和实体之后，下一步是通过创建引用字段让价格设置和交易实体可以识别任何自定义实体或选项集。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-108">After custom fields and entities have been created, the next step is to make price setup and transactional entities aware of any custom entities or option sets by creating reference fields.</span></span> <span data-ttu-id="3dc2c-109">根据定价维度列表中包含的是选项集维度和/或实体维度，相应执行 **基于选项集的自定义定价维度** 和/或 **基于实体的自定义定价维度**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-109">Depending on whether your pricing dimensions list includes option set dimensions or entity dimensions or both, follow only the steps in **Option set-based custom pricing dimensions** or **Entity-based custom pricing dimensions**, or both, respectively.</span></span>

### <a name="option-set-based-custom-pricing-dimensions"></a><span data-ttu-id="3dc2c-110">基于选项集的自定义定价维度</span><span class="sxs-lookup"><span data-stu-id="3dc2c-110">Option set-based custom pricing dimensions</span></span>
<span data-ttu-id="3dc2c-111">如果自定义定价维度基于选项集，请将其作为字段添加到关键 Project Service 实体。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-111">When a custom pricing dimension is option set-based, add it as a field to key Project Service entities.</span></span> <span data-ttu-id="3dc2c-112">在以下过程中，**资源工作位置** 和 **资源工作时间** 用作基于选项集的定价维度。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-112">In the following procedure, **Resource Work Location** and **Resource Work Hours** are used as the option set-based pricing dimensions.</span></span> <span data-ttu-id="3dc2c-113">首先必须将其作为字段添加到定价维度 **角色价格** 和 **角色价格加价**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-113">These must first be added as fields to the pricing entities, **Role Price** and **Role Price Markup**.</span></span>

1. <span data-ttu-id="3dc2c-114">在 Project Service Automation (PSA) 中，单击 **设置** > **解决方案**，然后双击 **\<your organization name> 定价维度**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-114">In Project Service Automation (PSA), click **Settings** > **Solutions**, and then double-click **\<your organization name> pricing dimensions**.</span></span> 
2. <span data-ttu-id="3dc2c-115">在解决方案资源管理器中左侧导航窗格上，选择 **实体 > 角色价格**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-115">In Solution Explorer, on the left navigation pane, select **Entities > Role Price**.</span></span>
3. <span data-ttu-id="3dc2c-116">展开实体 **角色价格**，然后选择 **字段**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-116">Expand the entity **Role Price** and select **Fields**.</span></span>
4. <span data-ttu-id="3dc2c-117">单击 **新建** 创建名称为 **资源工作位置** 的新字段，然后选择 **选项集** 作为字段类型。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-117">Click **New** to create a new field called **Resource Work Location** and select **Option set** as the field type.</span></span> 
5. <span data-ttu-id="3dc2c-118">选择 **使用现有选项集**，选择 **资源工作位置** 选项集，然后单击 **保存**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-118">Select **Use an existing Option set**, select the **Resource Work Location** option set, and then click **Save**.</span></span>
6. <span data-ttu-id="3dc2c-119">重复步骤 1 - 5 将此字段添加到 **角色价格加价** 实体。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-119">Repeat steps 1 - 5 to add this field to the **Role Price Markup** entity.</span></span> 
7. <span data-ttu-id="3dc2c-120">对 **资源工作时间** 选项集重复步骤 1 - 5。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-120">Repeat steps 1 - 5 for the **Resource Work Hours** option set.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3dc2c-121">将一个字段添加到多个实体时，请在所有实体中使用同一个字段名称。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-121">When you add a field to more than one entity, use the same field name across all of the entities.</span></span> 

> ![将“资源工作位置”添加到“角色价格”](media/RWL-Field.png)

<span data-ttu-id="3dc2c-123">在项目的销售和估算阶段，**常规工作时间** 和 **加班工作时间** 中完成 **本地** 和 **现场** 工作所需工作量的估算用于估算报价单/项目的值。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-123">In the sales and estimation phases for a project, estimates of the work effort that is required to complete **Local** and **Onsite** work, in **Regular hours** and **Overtime hours**  are used to estimate the value of the Quote/Project.</span></span> <span data-ttu-id="3dc2c-124">将把字段 **资源工作位置** 和 **资源工作时间** 添加到估算实体 **报价单明细详细信息**、**合同子项详细信息**、**项目任务**、**项目团队成员** 和 **估算明细**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-124">The fields **Resource Work Location** and **Resource Work Hours** will be added to the estimation entities, **Quote Line Detail**, **Contract Line detail**, **Project Task**, **Project Team Member**, and **Estimate Line**.</span></span>

1. <span data-ttu-id="3dc2c-125">在 PSA 中，单击 **设置** > **解决方案**，然后双击 **\<your organization name> 定价维度**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-125">In PSA, click **Settings** > **Solutions**, and then double-click **\<your organization name> pricing dimensions**.</span></span> 
2. <span data-ttu-id="3dc2c-126">在解决方案资源管理器中左侧导航窗格上，选择 **实体 > 报价单明细详细信息**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-126">In Solution Explorer, on the left navigation pane, select **Entities > Quote Line Detail**.</span></span>
3. <span data-ttu-id="3dc2c-127">展开 **报价单明细详细信息** 实体，然后选择 **字段**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-127">Expand the **Quote Line Detail** entity, and select **Fields**.</span></span>
4. <span data-ttu-id="3dc2c-128">单击 **新建** 创建名称为 **资源工作位置** 的新字段，然后选择字段类型 **选项集**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-128">Click **New** to create a new field called **Resource Work Location** and select the field type, **Option set**.</span></span> 
5. <span data-ttu-id="3dc2c-129">选择 **使用现有选项集** 和 **资源工作位置**，然后单击 **保存**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-129">Select **Use an existing Option set** and **Resource Work Location**, and then click **Save**.</span></span>
6. <span data-ttu-id="3dc2c-130">重复步骤 1 - 5 将此字段添加到 **项目合同子项详细信息**、**项目任务**、**项目团队成员** 和 **估算明细** 实体。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-130">Repeat steps 1 - 5 to add this field to the **Project Contract line detail**,**Project Task**, **Project Team Member**, and **Estimate Line** entities.</span></span>
7. <span data-ttu-id="3dc2c-131">对 **资源工作时间** 选项集重复步骤 1 - 6。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-131">Repeat steps 1 - 6 for the **Resource Work Hours** option set.</span></span> 

> ![将“资源工作位置”添加到“估算明细”](media/RWL-Default-Value.png)


<span data-ttu-id="3dc2c-133">对于交付和开票，需要对已完成工作准确定价，以便在“项目实际值”中选择其是在 **本地** 还是 **现场** 执行的，以及是在 **常规工作时间** 还是 **加班** 完成的。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-133">For delivery and invoicing, completed work needs to be accurately priced to select whether it was performed **Local** or **Onsite**, and whether it was completed during **Regular hours** or **Overtime** on the Project Actuals.</span></span> <span data-ttu-id="3dc2c-134">应该将 **资源工作位置** 和 **资源工作时间** 字段添加到 **时间条目**、**实际值**、**发票明细详细信息** 和 **日记帐行** 实体。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-134">The **Resource Work Location** and **Resource Work hours** fields should be added to the **Time Entry**, **Actual**, **Invoice Line Detail**, and **Journal Line** entities.</span></span>

1. <span data-ttu-id="3dc2c-135">在 PSA 中，单击 **设置** > **解决方案**，然后双击 **\<your organization name> 定价维度**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-135">In PSA, click **Settings** > **Solutions**, and then double-click **\<your organization name> pricing dimensions**.</span></span>
2. <span data-ttu-id="3dc2c-136">在解决方案资源管理器中左侧导航窗格上，选择 **实体 > 时间条目**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-136">In Solution Explorer, on the left navigation pane, select  **Entities > Time Entry**.</span></span>
3. <span data-ttu-id="3dc2c-137">展开 **报价单明细详细信息** 实体，然后选择 **字段**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-137">Expand the **Quote Line Detail** entity, and then select **Fields**.</span></span>
4. <span data-ttu-id="3dc2c-138">单击 **新建** 创建名称为 **资源工作位置** 的新字段，然后选择 **选项集** 作为字段类型。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-138">Click **New** to create a new field called **Resource Work Location** and select **Option set** as the field type.</span></span> 
5. <span data-ttu-id="3dc2c-139">选择 **使用现有选项集**，选择 **资源工作位置** 选项集，然后单击 **保存**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-139">Select **Use an existing Option set**, select the **Resource Work Location** option set, and then click **Save**.</span></span>
6. <span data-ttu-id="3dc2c-140">重复步骤 1 - 5 将此字段添加到 **实际值**、**发票明细详细信息**,和 **日记帐行** 实体。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-140">Repeat steps 1 - 5 to add this field to the **Actual**, **Invoice Line Detail**, and **Journal Line** entities.</span></span>
7. <span data-ttu-id="3dc2c-141">对 **资源工作时间** 选项集重复步骤 1 - 6。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-141">Repeat steps 1 - 6 for the **Resource Work Hours** option set.</span></span> 

> ![将“资源工作位置”添加到“时间条目”](media/RWL-time-entry.png)

<span data-ttu-id="3dc2c-143">这将完成基于选项集的自定义维度所需架构更改。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-143">This completes the schema changes required for option set-based custom dimensions.</span></span>

## <a name="entity-based-custom-pricing-dimensions"></a><span data-ttu-id="3dc2c-144">基于实体的自定义定价维度</span><span class="sxs-lookup"><span data-stu-id="3dc2c-144">Entity-based custom pricing dimensions</span></span>

<span data-ttu-id="3dc2c-145">当自定义定价维度是实体时，您将添加维度实体与关键 Project Service 实体之间的 1:N 关系。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-145">When the custom pricing dimension is an entity, you will add 1:N relationships between the dimension entity and key Project Service entities.</span></span> <span data-ttu-id="3dc2c-146">如果使用上面的“标准标题”示例，则应该为每位员工分派一个标准标题。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-146">Using the Standard Title example from above, it is reasonable to expect that each employee is assigned a standard title.</span></span> <span data-ttu-id="3dc2c-147">因此，您需要“标准标题”到“可预订资源”的 1:N 关系，或 N:1 关系（如果是从“可预订资源”到“标准标题”创建的）。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-147">SAs a result, you will need a 1:N relationship from Standard Title to Bookable Resource, or a N:1 relationship if it were created from Bookable Resource to Standard Title.</span></span>

1. <span data-ttu-id="3dc2c-148">在 PSA 中，单击 **设置** > **解决方案**，然后双击 **\<your organization name> 定价维度**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-148">In PSA, click **Settings** > **Solutions**, and then double-click **\<your organization name> pricing dimensions**.</span></span> 
2. <span data-ttu-id="3dc2c-149">在解决方案资源管理器中左侧导航窗格上，选择 **实体 > 标准标题**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-149">In Solution Explorer, on the left navigation pane, select **Entities > Standard Title**.</span></span>
3. <span data-ttu-id="3dc2c-150">展开 **标准标题** 实体，然后选择 **1:N 关系**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-150">Expand the **Standard Title** entity and select **1:N Relationships**.</span></span>
4. <span data-ttu-id="3dc2c-151">单击 **新建** 创建名称为 **标准标题到可预订资源** 的 1:N 关系。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-151">Click **New** to create a new 1:N relationship called **Standard Title to Bookable Resource**.</span></span> <span data-ttu-id="3dc2c-152">输入所需信息，然后单击 **保存**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-152">Enter the required information, and then click **Save**.</span></span>

> ![将“标准标题”作为引用字段添加到“可预订资源”](media/ST-BR.png)

<span data-ttu-id="3dc2c-154">还需要将“标准标题”添加到 Project Service 的定价实体，如 **角色价格** 和 **角色价格加价**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-154">The Standard Title will also need to be added to Project Service Pricing entities, **Role Price** and **Role Price Markup**.</span></span> <span data-ttu-id="3dc2c-155">还使用 **标准标题** 与 **角色** 实体之间和 **标准标题** 与 **角色价格加价** 实体之间的 1:N 关系完成此操作。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-155">This is also completed using 1:N relationships between the **Standard Title** and **Role Price** entities and **Standard Title** and **Role Price Markup** entities.</span></span>

1. <span data-ttu-id="3dc2c-156">在解决方案资源管理器中左侧导航窗格上，选择 **实体 > 标准标题**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-156">In Solution Explorer, on the left navigation pane, select **Entities > Standard Title**.</span></span>
2. <span data-ttu-id="3dc2c-157">展开 **标准标题** 实体，然后选择 **1:N 关系**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-157">Expand the **Standard Title** entity and select **1:N Relationships**.</span></span>
3. <span data-ttu-id="3dc2c-158">单击 **新建** 创建名称为 **标准标题到角色价格** 的 1:N 关系。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-158">Click **New** to create a new 1:N relationship called **Standard Title to Role Price**.</span></span> <span data-ttu-id="3dc2c-159">输入所需信息，然后单击 **保存**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-159">Enter the required information, and then click **Save**.</span></span>
4. <span data-ttu-id="3dc2c-160">重复步骤 1 - 4 以创建 **标准标题** 与 **角色价格加价** 实体之间的 1:N 关系。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-160">Repeat steps 1 - 4 to create 1:N relationships between the **Standard Title** and **Role Price Markup** entities,</span></span>

<span data-ttu-id="3dc2c-161">在项目的销售和估算阶段，若要为报价单/项目定价，需要为每个标准标题估算工作量。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-161">In the sales and estimation phases for the project, to price the Quote/Project, estimates of the work effort are required for each standard title.</span></span> <span data-ttu-id="3dc2c-162">这意味着需要从“标准标题”到 Project Service 中的以下每个估算实体的 1:N 关系：</span><span class="sxs-lookup"><span data-stu-id="3dc2c-162">This means that 1:N relationships from Standard Title to each of these estimation entities in Project Service are needed:</span></span> 

- <span data-ttu-id="3dc2c-163">**报价单明细详细信息**</span><span class="sxs-lookup"><span data-stu-id="3dc2c-163">**Quote line Detail**</span></span>
- <span data-ttu-id="3dc2c-164">**项目合同子项详细信息**</span><span class="sxs-lookup"><span data-stu-id="3dc2c-164">**Project Contract Line Detail**</span></span>
- <span data-ttu-id="3dc2c-165">**项目任务**</span><span class="sxs-lookup"><span data-stu-id="3dc2c-165">**Project Task**</span></span>
- <span data-ttu-id="3dc2c-166">**项目团队成员**</span><span class="sxs-lookup"><span data-stu-id="3dc2c-166">**Project Team Member**</span></span>
- <span data-ttu-id="3dc2c-167">**估计值明细**</span><span class="sxs-lookup"><span data-stu-id="3dc2c-167">**Estimate Line**</span></span>

5. <span data-ttu-id="3dc2c-168">重复步骤 1 - 5 以创建从 **标准标题** 到 **报价单明细详细信息**、**项目合同子项详细信息**、**项目任务**、**项目团队成员** 和 **估算明细** 的 1:N 关系。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-168">Repeat steps 1 - 5 to create 1:N relationships from **Standard Title** to **Quote line Detail**, **Project Contract Line Detail**, **Project Task**, **Project Team Member**, and **Estimate Line**.</span></span>

> ![将“标准标题”作为引用字段添加到“估算明细”](media/ST-Estimate-Line.png)

<span data-ttu-id="3dc2c-170">在交付和开票阶段，必须在“项目实际值”中为每个标准标题完成的工作准确定价。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-170">In the Delivery and Invoicing phases, the work completed by each standard title must be accurately priced on the Project Actuals.</span></span> <span data-ttu-id="3dc2c-171">这意味着需要从 **标准标题** 到 **时间条目**、**实际值**、**发票明细详细信息** 和 **日记帐行实体** 的 1:N 关系。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-171">This means that there needs to be 1:N relationships from **Standard Title** to **Time Entry**, **Actual**, **Invoice Line Detail**, and **Journal Line entities**.</span></span>

6. <span data-ttu-id="3dc2c-172">重复步骤 1 - 6 创建从 **标准标题** 到 **时间条目**、**实际值**、**发票明细详细信息** 和 **日记帐行实体** 的 1:N 关系。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-172">Repeat steps 1 - 6 to create 1:N relationships from **Standard Title** to **Time Entry**, **Actual**, **Invoice Line Detail**, and **Journal Line entities**.</span></span>

> ![将“标准标题”作为引用字段添加到“时间条目”](media/ST-Mapping.png)

### <a name="set-up-dimension-value-defaulting-using-the-mappings-features-of-the-platform"></a><span data-ttu-id="3dc2c-174">使用平台的映射功能设置默认维度值</span><span class="sxs-lookup"><span data-stu-id="3dc2c-174">Set up Dimension value defaulting using the mappings features of the platform</span></span>
<span data-ttu-id="3dc2c-175">对于“时间条目”，最好是让系统默认采用记录时间条目的“可预订资源”中“时间条目”内的标准标题。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-175">For Time Entry, it would be helpful to have the system default the standard title on the Time Entry from the Bookable Resource that is recording the time entry.</span></span> <span data-ttu-id="3dc2c-176">请执行以下步骤将 1:N 关系中的字段映射从 **可预订资源** 添加到 **时间条目**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-176">Use the following steps to add field mappings on the 1:N relationship from **Bookable Resource** to **Time Entry**.</span></span>

1. <span data-ttu-id="3dc2c-177">在解决方案资源管理器中左侧导航窗格上，选择 **实体 > 标准标题**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-177">In Solution Explorer, on the left navigation pane, select **Entities > Standard Title**.</span></span>
2. <span data-ttu-id="3dc2c-178">展开 **标准标题** 实体，然后选择 **1:N 关系**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-178">Expand the **Standard Title** entity and select **1:N Relationships**.</span></span>
3. <span data-ttu-id="3dc2c-179">双击 **可预订资源到时间条目**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-179">Double-click **Bookable Resource to Time Entry**.</span></span> <span data-ttu-id="3dc2c-180">在 **关系** 页中，单击 **使用映射字段**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-180">On the **Relationship** page, click **Use Field mappings**.</span></span> 
4. <span data-ttu-id="3dc2c-181">单击 **新建** 创建 **可预订资源** 实体中的 **标准标题** 字段到 **时间条目** 字段中的 **标准标题** 引用字段的新字段映射。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-181">Click **New** to create a new field mapping between the **Standard Title** field on the **Bookable Resource** entity to the **Standard Title** reference field on **Time Entry** entity.</span></span> 

> ![设置字段映射以便执行从“可预订资源”到“时间条目”的标准标题默认设置](media/ST-Mapping2.png)


<span data-ttu-id="3dc2c-183">这将完成基于实体的自定义维度所需架构更改。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-183">This completes the schema changes required for entity-based custom dimensions.</span></span>

##  <a name="add-custom-fields-to-forms-views-and-business-rules"></a><span data-ttu-id="3dc2c-184">向表单、视图和业务规则添加自定义字段</span><span class="sxs-lookup"><span data-stu-id="3dc2c-184">Add custom fields to forms, views, and business rules</span></span>

<span data-ttu-id="3dc2c-185">执行所有必需的架构更改之后，下一步是通过将字段添加到窗体和视图，在 UI 中显示这些字段。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-185">After you have made all of the required schema changes, the next step is to make the fields visible in the UI by adding the fields to the forms and views.</span></span>

1. <span data-ttu-id="3dc2c-186">打开窗体或视图。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-186">Open the form or the view.</span></span> <span data-ttu-id="3dc2c-187">在右侧导航窗格上，选择字段，然后将其拖到窗体区域中。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-187">On the right navigation pane, select the field and drag it on to the form canvas.</span></span> 
2. <span data-ttu-id="3dc2c-188">如果在编辑视图，请使用右侧导航窗格单击 **添加字段**，在 **字段列表** 对话框中选择所需字段， 然后单击 **确定**。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-188">If you are editing a view, use the right navigation pane, click **Add fields**, and in the **Field listing** dialog box, select the fields that you need and click **Ok**.</span></span>

<span data-ttu-id="3dc2c-189">下表提供需要更新的大量自带窗体和视图的列表（按实体排列），将使用新字段更新这些窗体和视图。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-189">The following table provides a comprehensive list of out-of-the-box forms and views, by entity, that will need to be updated with the new fields.</span></span> <span data-ttu-id="3dc2c-190">如果这些实体的自定义项中有任何其他视图或窗体，请将新字段也添加到这些视图或窗体。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-190">If you have any additional views or forms in your customizations on these entities, add the new fields to those as well.</span></span>

| <span data-ttu-id="3dc2c-191">Project Service 实体</span><span class="sxs-lookup"><span data-stu-id="3dc2c-191">Project Service Entity</span></span>        | <span data-ttu-id="3dc2c-192">需要新字段的窗体</span><span class="sxs-lookup"><span data-stu-id="3dc2c-192">Forms that need the new field</span></span>   |<span data-ttu-id="3dc2c-193">需要新字段的视图</span><span class="sxs-lookup"><span data-stu-id="3dc2c-193">Views that need the new field</span></span>      |
| ------------------------------|---------------------------------|----------------------------------|
|  <span data-ttu-id="3dc2c-194">角色价格</span><span class="sxs-lookup"><span data-stu-id="3dc2c-194">Role Price</span></span>|<span data-ttu-id="3dc2c-195">• 信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-195">• Information</span></span> |<span data-ttu-id="3dc2c-196">• 可用的资源类别价格</span><span class="sxs-lookup"><span data-stu-id="3dc2c-196">• Active Resource Category Prices</span></span><br> <span data-ttu-id="3dc2c-197">• 资源类别价格关联视图</span><span class="sxs-lookup"><span data-stu-id="3dc2c-197">• Resource Category Price Associated View</span></span>|
|  <span data-ttu-id="3dc2c-198">角色价格加价</span><span class="sxs-lookup"><span data-stu-id="3dc2c-198">Role Price Markup</span></span>|<span data-ttu-id="3dc2c-199">• 信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-199">• Information</span></span>|<span data-ttu-id="3dc2c-200">• 可用角色价格加价</span><span class="sxs-lookup"><span data-stu-id="3dc2c-200">• Active Role Price Markup</span></span><br><span data-ttu-id="3dc2c-201">• 角色价格加价关联视图</span><span class="sxs-lookup"><span data-stu-id="3dc2c-201">• Role Price Markup Associated View</span></span>|
|  <span data-ttu-id="3dc2c-202">报价单明细详细信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-202">Quote line detail</span></span>|<span data-ttu-id="3dc2c-203">• 项目信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-203">• Project Information</span></span><br><span data-ttu-id="3dc2c-204">• 项目快速创建</span><span class="sxs-lookup"><span data-stu-id="3dc2c-204">• Project Quick Create</span></span>|<span data-ttu-id="3dc2c-205">• 可用的报价单明细详细信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-205">• Active Quote Line Detail</span></span><br><span data-ttu-id="3dc2c-206">• 合并的报价单明细详细信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-206">• Combined Quote Line Details</span></span><br><span data-ttu-id="3dc2c-207">• 报价单明细详细信息关联视图</span><span class="sxs-lookup"><span data-stu-id="3dc2c-207">• Quote Line Detail associated view</span></span>|
|  <span data-ttu-id="3dc2c-208">项目合同子项详细信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-208">Project Contract line detail</span></span>|<span data-ttu-id="3dc2c-209">• 项目信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-209">• Project Information</span></span><br><span data-ttu-id="3dc2c-210">• 项目快速创建</span><span class="sxs-lookup"><span data-stu-id="3dc2c-210">• Project Quick Create</span></span>|<span data-ttu-id="3dc2c-211">• 合并的合同子项详细信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-211">• Combined Contract Line Details</span></span><br><span data-ttu-id="3dc2c-212">• 可用的合同子项详细信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-212">• Active Contract Line Details</span></span><br><span data-ttu-id="3dc2c-213">• 合同子项详细信息关联视图</span><span class="sxs-lookup"><span data-stu-id="3dc2c-213">• Contract Line Details Associated View</span></span>|
|  <span data-ttu-id="3dc2c-214">项目任务</span><span class="sxs-lookup"><span data-stu-id="3dc2c-214">Project Task</span></span>|<span data-ttu-id="3dc2c-215">• 信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-215">• Information</span></span><br><span data-ttu-id="3dc2c-216">• 新窗体</span><span class="sxs-lookup"><span data-stu-id="3dc2c-216">• New Form</span></span>||
|  <span data-ttu-id="3dc2c-217">项目团队成员</span><span class="sxs-lookup"><span data-stu-id="3dc2c-217">Project Team Member</span></span>|<span data-ttu-id="3dc2c-218">• 信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-218">• Information</span></span><br><span data-ttu-id="3dc2c-219">• 新窗体</span><span class="sxs-lookup"><span data-stu-id="3dc2c-219">• New Form</span></span>|<span data-ttu-id="3dc2c-220">• 可用的项目团队成员</span><span class="sxs-lookup"><span data-stu-id="3dc2c-220">• Active Project Team Members</span></span><br><span data-ttu-id="3dc2c-221">• 项目团队成员</span><span class="sxs-lookup"><span data-stu-id="3dc2c-221">• Project Team Members</span></span><br><span data-ttu-id="3dc2c-222">• 项目团队成员关联视图</span><span class="sxs-lookup"><span data-stu-id="3dc2c-222">• Project Team members associated View</span></span>|
|  <span data-ttu-id="3dc2c-223">时间条目</span><span class="sxs-lookup"><span data-stu-id="3dc2c-223">Time Entry</span></span>|<span data-ttu-id="3dc2c-224">• 信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-224">• Information</span></span><br><span data-ttu-id="3dc2c-225">• 创建时间条目</span><span class="sxs-lookup"><span data-stu-id="3dc2c-225">• Create Time Entry</span></span>|<span data-ttu-id="3dc2c-226">• 我的按日期列出的时间条目</span><span class="sxs-lookup"><span data-stu-id="3dc2c-226">• My Time Entries By Date</span></span><br><span data-ttu-id="3dc2c-227">• 我本周的时间条目</span><span class="sxs-lookup"><span data-stu-id="3dc2c-227">• My time Entries for this week</span></span><br><span data-ttu-id="3dc2c-228">• 供审批的时间条目</span><span class="sxs-lookup"><span data-stu-id="3dc2c-228">• Time entries for approval</span></span>|
|  <span data-ttu-id="3dc2c-229">日记帐行</span><span class="sxs-lookup"><span data-stu-id="3dc2c-229">Journal Line</span></span>|<span data-ttu-id="3dc2c-230">• 信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-230">• Information</span></span><br><span data-ttu-id="3dc2c-231">• 快速创建</span><span class="sxs-lookup"><span data-stu-id="3dc2c-231">• Quick create</span></span>|<span data-ttu-id="3dc2c-232">• 可用的日记帐行</span><span class="sxs-lookup"><span data-stu-id="3dc2c-232">• Active journal lines</span></span><br><span data-ttu-id="3dc2c-233">• 日记帐行关联视图</span><span class="sxs-lookup"><span data-stu-id="3dc2c-233">• Journal Line associated view</span></span>|
|  <span data-ttu-id="3dc2c-234">发票明细详细信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-234">Invoice Line Detail</span></span>|<span data-ttu-id="3dc2c-235">• 信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-235">• Information</span></span><br><span data-ttu-id="3dc2c-236">• 快速创建</span><span class="sxs-lookup"><span data-stu-id="3dc2c-236">• Quick create</span></span>|<span data-ttu-id="3dc2c-237">• 可用的发票明细详细信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-237">• Active Invoice Line Details</span></span><br><span data-ttu-id="3dc2c-238">• 应计费发票交易记录</span><span class="sxs-lookup"><span data-stu-id="3dc2c-238">• Chargeable Invoice Transactions</span></span><br><span data-ttu-id="3dc2c-239">• 免费发票交易记录</span><span class="sxs-lookup"><span data-stu-id="3dc2c-239">• Complimentary Invoice Transactions</span></span><br><span data-ttu-id="3dc2c-240">• 发票明细详细信息关联视图</span><span class="sxs-lookup"><span data-stu-id="3dc2c-240">• Invoice Line Detail associated view</span></span><br><span data-ttu-id="3dc2c-241">• 非应计费发票交易记录</span><span class="sxs-lookup"><span data-stu-id="3dc2c-241">• Non-Chargeable Invoice Transactions</span></span>|
|  <span data-ttu-id="3dc2c-242">实际值</span><span class="sxs-lookup"><span data-stu-id="3dc2c-242">Actual</span></span>|<span data-ttu-id="3dc2c-243">• 信息</span><span class="sxs-lookup"><span data-stu-id="3dc2c-243">• Information</span></span><br><span data-ttu-id="3dc2c-244">• 可用的实际值</span><span class="sxs-lookup"><span data-stu-id="3dc2c-244">• Active Actuals</span></span>|<span data-ttu-id="3dc2c-245">• 实际值关联视图</span><span class="sxs-lookup"><span data-stu-id="3dc2c-245">• Actual Associated view</span></span>|

<span data-ttu-id="3dc2c-246">还可能需要在业务规则中添加自定义字段，具体取决于您已定义的内容。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-246">Custom fields may also need to be added on business rules depending on what you have defined.</span></span> <span data-ttu-id="3dc2c-247">业务规则 **基于状态的时间条目的可编辑性** 就是一个现成示例。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-247">One out-of-the-box example is for the business rule **Editability of Time Entry based on status**.</span></span> <span data-ttu-id="3dc2c-248">此规则定义当时间条目处于不可编辑状态（如 **已批准**）时，需要锁定哪些字段。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-248">This rule defines which fields need to be locked when the Time Entry is in a non-editable status such as **Approved**.</span></span> <span data-ttu-id="3dc2c-249">向此业务规则添加字段，以便在时间条目的状态不是 **草稿** 或 **已返回** 时，锁定字段，使其不可编辑。</span><span class="sxs-lookup"><span data-stu-id="3dc2c-249">Add fields to this business rule so that the fields are locked for editing when the Time Entry is in a status other than **Draft** or **Returned**.</span></span>
