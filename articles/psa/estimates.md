---
title: 估算
description: 本主题提供有关 Dynamics 365 Project Service Automation 中的估算的信息。
author: rumant
ms.custom:
- dyn365-projectservice
ms.date: 1/31/2019
ms.topic: article
ms.author: rumant
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365CE
- D365PS
- ProjectOperations
ms.openlocfilehash: ebb59d2b38bf99aed15206646e77c74003aba2a92a6d8d262e6e7b2017285ed3
ms.sourcegitcommit: 7f8d1e7a16af769adb43d1877c28fdce53975db8
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/06/2021
ms.locfileid: "6992375"
---
# <a name="estimates"></a>估算

[!include [banner](../includes/psa-now-project-operations.md)]

[!INCLUDE[cc-applies-to-psa-app-3.x](../includes/cc-applies-to-psa-app-3x.md)]

在基于项目的报价单中，可使用报价单明细详细信息实体估算交付项目所需工作。 然后可以与客户共享该估算。

基于项目的报价单明细中不必包含任何报价单明细详细信息。 但是，也可以包含大量报价单明细详细信息。 报价单明细详细信息用于估算时间、支出或费用。 PSA 不允许报价单明细详细信息中包含材料估算。 这些估算称为交易分类。 也可以在交易分类中输入估算税额。

除了交易分类，报价单明细详细信息中还有交易类型。 PSA 支持报价单明细详细信息中包含两种交易类型：**成本** 和 **项目合同**。

## <a name="estimate-by-using-a-contract"></a>使用合同估算

如果在创建基于项目的合同时使用了 PSA 报价单，将把为报价单中每项报价单明细进行的估算复制到项目合同中。 项目合同的结构类似项目报价单的结构，具有明细、明细详细信息和发票计划。

可直接在项目合同中进行估算，就像在项目报价单中进行一样。 对于项目报价，则使用合同子项和合同子项详细信息进行估算。 也可以使用自下而上的估算方法从创建的项目计划生成合同子项详细信息。

合同子项详细信息可用于估算时间、支出或费用。 也可以在合同子项详细信息中输入估算税额。

PSA 不允许合同子项详细信息中包含材料估算。

支持对项目合同执行的流程为创建发票和确认发票。 创建发票将创建基于项目的发票草稿，其中包含截止当前日期的所有未记帐实际销售值。

确认将把合同设置为只读，并将其状态从 **草稿** 更改为 **已确认**。 此操作执行之后不能撤消。 因为此操作是永久性的，所以最好是让合同保持 **草稿** 状态。

草稿合同和已确认合同之间的唯一区别是其状态和可以编辑草稿合同，但不能编辑已确认合同。 可以对草稿合同和已确认合同执行发票创建和跟踪实际值。

PSA 不支持更改合同或项目中的订单。

## <a name="estimating-projects"></a>估算项目

可估算项目的时间和支出。 PSA 不允许估算项目的材料或费用。

创建任务并确定执行任务所需通用资源的属性时，将生成时间估算。 时间估算从计划任务生成。 如果在计划上下文外部创建通用团队成员，则不创建时间估算。

将在 **估算** 页的网格中输入支出估算。

## <a name="understanding-estimation"></a>了解估算

请按照下表了解估算阶段的业务逻辑。

| 场景                                                                                                                                                                                                                                                                                                                                          | 实体记录                                                                                                                                                                                                       | 交易类型 | 交易分类 | 其他信息                                                            |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|-------------|-----------------------------------------------------------------------------------|
| 当需要估算报价单中的时间的销售值时                                                                                                                                                                                                                                                                                    | 创建报价单明细详细信息 (QLD) 记录                                                                                                                                                                               | 项目合同 | Time        | 销售端 QLD 行中的交易来源字段引用成本端 QLD |
|                                                                                                                                                                                                                                                                                     | 系统将再创建一条 QLD 记录来存储相应的成本值。 系统将把所有非货币字段从销售 QLD 复制到成本 QLD。                                                                                                                                                                               | 成本 | Time        | 销售端报价单明细详细信息 (QLD) 行中的交易来源字段引用成本端 QLD |
| 当需要估算合同中的时间的销售值时                                                                                                                                                                                                                                                                                 | 创建项目合同子项详细信息 (CLD) 记录                                                                                                                                                                    | 项目合同 | Time        | 销售端 CLD 行中的交易来源字段引用成本 CLD      |
|                                                                                                                                                                                                                                                                                  | 系统将再创建一条 CLD 记录来存储相应的成本值。 系统将把所有非货币字段从销售 CLD 复制到成本 CLD。                                                                                                                                                                    | 成本 | Time        | 销售端 CLD 行中的交易来源字段引用成本 CLD      |
| 当用户描述项目任务的资源时                                                                                                                                                                                                                                                                                            | 使用所有必需定价维度创建任务时，将创建用于显示任务的销售值的估算明细记录。 角色和部门是 OOB Project Service 定价维度 | 项目合同 | Time        |                                                                                   |
|     | 使用所有必需定价维度创建任务时，将创建用于显示任务的成本值的估算明细记录。 系统将把所有非货币字段从销售估算明细复制到成本估算明细。 角色和部门是成本和帐单费率的 OOB PSA 定价维度。                                                                                                                                                                                                                | 成本             | Time           |                                                                                   |



## <a name="customizing-the-quote-line-detail-and-contract-line-detail-entities"></a>自定义报价单明细详细信息和合同子项详细信息实体

如果在报价单明细详细信息中添加了自定义字段，并且希望系统输入字段的值作为创建的相关成本明细中的默认值，请使用 PreOperationContractLineDetailUpdate 和 PreOperationQuoteLineDetailUpdate 插件注册工具。 更改报价单明细详细信息或合同子项之后，必须重新注册这些插件。 执行以下步骤完成流程。

1. 打开 PluginRegistrationTool，然后连接到您的在线实例。
2. 选择 **搜索**，然后搜索要更新的插件。

    ![“搜索树”对话框。](media/basic-guide-19.png)

3. 选择插件，然后在主页中选择 **选择**。
4. 选择要更新的插件的步骤，然后选择 **更新**。

    ![在插件中选择步骤。](media/basic-guide-20.png)

5. 在 **更新现有步骤** 对话框的 **筛选属性** 字段中，选择省略号按钮 (**...**)：
 
    ![“更新现有步骤”对话框。](media/basic-guide-21.png)

6. 在 **选择属性** 对话框中，选中自定义属性的复选框。

    ![“选择属性”对话框。](media/basic-guide-22.png)

7. 选择 **确定** 关闭对话框，然后选择 **更新步骤**。
 
    ![“更新步骤”按钮。](media/basic-guide-23.png)

8. 对第二个插件重复步骤 1 到 7。
9. 关闭 PluginRegistrationTool。


[!INCLUDE[footer-include](../includes/footer-banner.md)]